

OUTPUT_DIR: "outputs/"
SEED: 7
SHOW_STEP: 100
SAVE_EPOCH: 100
MAX_EPOCH: 500
TRAIN_STEP: 500 # 每个训练epoch有多少次迭代  
ALGORITHM:
  NAME: "MixMatch"
  CONFIDENCE_THRESHOLD: 0.95  

  PRE_TRAIN: 
    ENABLE: True
    WARMUP_EPOCH: 30
    SimCLR: # 预训练使用对比学习
      TEMPERATURE: 0.5
      K: 50 # 'Top k most similar images used to predict the label'
      # FEATURE_DIM: 64
   
MODEL:
  NAME: "WRN_28_2"
  LOSS:
    LABELED_LOSS: "MixmatchLoss" # 总loss
    WITH_LABELED_COST_SENSITIVE: False 

  OPTIMIZER:
    TYPE: 'SGD'
    BASE_LR: 0.03
    MOMENTUM: 0.9
    WEIGHT_DECAY: 2e-4 
DATASET:
  NAME: "cifar100"
  ROOT: "./data/cifar100" 
  NUM_CLASSES: 100
  GROUP_SPLITS: [30,35,35]
  
  IMB_TYPE: 'exp'
  DL:
    NUM_LABELED_HEAD: 150
    IMB_FACTOR_L: 100
  DU: 
    ID:
      NUM_UNLABELED_HEAD:   300 #
      IMB_FACTOR_UL: 100
      REVERSE_UL_DISTRIBUTION: False
    OOD:
      ENABLE: True
      DATASET: 'TIN'
      RATIO: 0.0 # n(ood)/n(du) OOD样本与无标签ID样本数量的比值  根据比值来确定OOD样本数量
    
    UNLABELED_BATCH_RATIO: 2
  NUM_WORKERS: 4
  SAMPLER:
    NAME: "RandomSampler"  
# RESUME: '/home/aa/xlhuang/Openset-LT-SSL/outputs/cifar100/MixMatch/WRN_28_2/DL-150-IF-100-DU300-IF_U-100/OOD-TIN-r-0.50/models/checkpoint.pth'