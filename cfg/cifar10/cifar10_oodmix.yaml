

OUTPUT_DIR: "outputs/"

SEED : 7  
SHOW_STEP: 100
SAVE_EPOCH: 100
MAX_EPOCH: 500
TRAIN_STEP: 500 # 
ALGORITHM:
  NAME: "OODMix"
  CONFIDENCE_THRESHOLD: 0.95
  ABLATION: 
    ENABLE: False
    DUAL_BRANCH: True
    MIXUP: True     
    OOD_DETECTION: False
    FEAT_LOSS: True
  PRE_TRAIN: 
    ENABLE: True
    WARMUP_EPOCH: 30
    SimCLR: #  
      ENABLE: True
      TEMPERATURE: 0.5
      # FEATURE_DIM: 128

  OOD_DETECTOR:
    TEMPERATURE: 0.5
    MAGNITUDE: 0.0014 #  
    THRESHOLD: 0.10004
    UPDATE_ITER: 5
    K: 10 # 
    DETECT_EPOCH: 30

  BRANCH1_MIXUP: False  
  BRANCH2_MIXUP: False  


MODEL:
  NAME: "Resnet34"
  LOSS:
    LABELED_LOSS: "CrossEntropyLoss" 
    LABELED_LOSS_CLASS_WEIGHT_TYPE: "None"     
    WITH_LABELED_COST_SENSITIVE: False
    UNLABELED_LOSS: "CrossEntropyLoss"
    UNLABELED_LOSS_WEIGHT: 1.0
    WITH_SUPPRESSED_CONSISTENCY: False 
    FEATURE_LOSS:
      TEMPERATURE: 1.0
      # WEIGHT: 0.5
      CENTER_DECAY_RATIO: 0.1
      ID_LOSS_WEIGHT: 0.1
      OOD_LOSS_WEIGHT: 0.1

  OPTIMIZER:
    TYPE: 'SGD'
    BASE_LR: 0.1
    MOMENTUM: 0.9
    WEIGHT_DECAY: 2e-4
  LR_SCHEDULER:
    TYPE: 'warmup'
    LR_STEP: [200,400] 
    LR_FACTOR: 0.01
    WARM_EPOCH: 5  

DATASET:
  NAME: "cifar10"
  ROOT: "./data/cifar10" 
  NUM_CLASSES: 10
  GROUP_SPLITS: [3,3,4]
  
  DOMAIN_DATASET_RETURN_INDEX: True
  UNLABELED_DATASET_RETURN_INDEX: True
  LABELED_DATASET_RETURN_INDEX: True
  IMB_TYPE: 'exp'
  DL:
    NUM_LABELED_HEAD: 1500
    IMB_FACTOR_L: 10
  DU:
    ID:
      NUM_UNLABELED_HEAD: 3000
      IMB_FACTOR_UL: 10
      REVERSE_UL_DISTRIBUTION: False
    OOD:
      ENABLE: True
      DATASET: 'TIN'
      RATIO: 0.75  
    
    UNLABELED_BATCH_RATIO: 2
  BATCH_SIZE: 64
  NUM_WORKERS: 2
  
  SAMPLER:
    NAME: "RandomSampler"  
  DUAL_SAMPLER:
    ENABLE: True
    NAME: "ClassReversedSampler"  
  
  TRANSFORM:
    UNLABELED_STRONG_AUG: True
    LABELED_STRONG_AUG: True
  